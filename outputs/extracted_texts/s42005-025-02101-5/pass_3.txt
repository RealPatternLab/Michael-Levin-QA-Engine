communications physics
A Nature Portfolio journal
Article

Neuroevolution of decentralized decision-
making in N-bead swimmers leads to
scalable and robust collective locomotion
Benedikt Hartl 1,2 Michael Levin 2,3 & Andreas Zöttl4

Many microorganisms swim by performing larger non-reciprocal shape deformations that are initiated
locally by molecular motors. However, it remains unclear how decentralized shape control determines
the movement of the entire organism. Here, we investigate how efficient locomotion emerges from
coordinated yet simple and decentralized decision-making of the body parts using neuroevolution
techniques. Our approach allows us to investigate optimal locomotion policies for increasingly large
microswimmer bodies, with emerging long-wavelength body shape deformations corresponding to
surprisingly efficient swimming gaits. The obtained decentralized policies are robust and tolerant
concerning morphological changes or defects and can be applied to artificial microswimmers for
cargo transport or drug delivery applications without further optimization "out of the box". Our work is
of relevance to understanding and developing robust navigation strategies of biological and artificial
microswimmers and, in a broader context, for understanding emergent levels of individuality and the
role of collective intelligence in Artificial Life.

Microorganisms are ubiquitous in nature and play an essential role in many
biological phenomena, ranging from pathogenic bacteria affecting our
health to phytoplankton as a key player in the marine ecosystem on a global
scale. A large variety of microorganisms live in viscous environments, and
their motion is governed by the physics of low Reynolds number hydro-
dynamics, where viscous forces dominate over inertia¹4. As a consequence,
a common strategy is to periodically deform their body shape in a non-
reciprocal fashion to swim. To thrive in the environment, they have
developed different tailored strategies to exploit their swimming capabilities,
such as actively navigating toward a nutrient-rich source, hunting down
prey, escaping predators, or reproducing". Besides being of direct biological
relevance, understanding the corresponding navigation strategies of
microorganisms bears potential for biomedical or technical applications,
potentially utilized by synthetic microswimmers deployed as targeted drug
delivery systems7-10.

Nature has evolved many different strategies and control mechanisms
for microswimmers to swim fast, efficiently, and adaptive to environmental
conditions: For example, swimming algae cells or sperm cells move with the
help of waving cilia or flagella¹¹, respectively, or amoebae such as
Dictyostelium¹² and unicellular protists such as Euglenia¹³ by deforming
their entire cell body. The associated deformation amplitudes and wave-
lengths can be on the order of the entire size of the organism.

In the last years, Reinforcement Learning¹¹ (RL) has been applied to
understand navigation strategies of microswimmers15,16, for example under
external fluid flow¹" or external fields¹, or to perform chemotaxis in the
presence of chemical gradients19-23. So far, most of these studies treat
microswimmers as rigid agents, i.e., explicitly omitting body deformations
or other internal degrees of freedom, and simply manipulate their ad hoc
swimming speed and rotation rates for control purposes to perform well in a
particular environment. Only very recent contributions19,24–29 consider the
constraints of physically force-free shape-deforming locomotion of plastic
model microswimmers in an effort to identify swimming gaits that explicitly
utilize the hydrodynamic interactions between different body parts in a
viscous environment. Modeling such a body-brain-environment offers
explicit and more realistic behavior of the response of an organism to
environmental conditions30,31.

The locomotion of microswimmers and microrobots moving in viscous
fluids at low Reynolds numbers can be modeled with various numerical
methods of different accuracy. Examples for actively deforming slender fila-
ments as they occur in biological systems or in soft robotics are slender body
theory (e.g., ref. 32), or Cosserat rod models (e.g., refs. 33,34). Yet the simplest
models, which usually outperform the aforementioned methods in terms of
computation time, discretize a filament or a microswimmer by inter-
connected beads where hydrodynamic interactions are captured in the

[PAGE 2] Results and discussion

[PAGE 2] The N-bead swimmer model

Here, we investigate swimming strategies optimized by RL and the corre-
sponding physical implications of N-bead generalized NG³5 swimmer
models moving in a fluid of viscosity μ. A swimmer consists of N co-
centrically aligned spheres of radius R located at positions x₁(t₁), i = 1..., N,
at time tk. These beads are connected pairwise by massless arms of length
li(tk) = Xi+1(tk) - xi(tk), as illustrated in Fig. 1a. The swimmer deforms and
moves by applying time-dependent forces F₁(tk) = F(tk) + F(tk) on the
beads. The active forces F(tk) are proposed by RL agents (see below), and
passive restoring forces¹ºF(tr) are applied when arm lengths li(tk) becomes
smaller than 0.7L, or lager than 1.3L0, where we choose Lo = 10R as
the reference arm length. The swimmer is force-free, ∑iFi(tk) = 0,
and the bead velocities vi(tk) are obtained in the Oseen approximation62,
v₁ = F;/(6πμR) + ∑j≠iF;/(4πμ|x; − x;|), (see the “Hydrodynamic interactions
and numerical details for the N-bead swimmer model" subsection in the
"Methods").

[PAGE 2] Modeling system-level decision-making with decentralized
controllers

To identify the active forces F(tk) on the beads, we assign an ensemble of
independent yet identical controllers to every bead which respectively can
only perceive local information about adjacent beads (such as distances and
velocities of their neighbors) and propose actions to update their respective
states (such as proposing bead-specific forces to update their own posi-
tions). Yet, these bead-specific agents follow a shared objective to collec-
tively self-propel the entire N-bead swimmer's body. More specifically-as
illustrated in Fig. 1 and detailed in the "Artificial neural network-based
decentralized controllers" subsection in the "Methods"-for each time to the
controller associated with the bead i perceives its left- and right-neighbor
distances, Li(tk) = {li(tk), li+1(tk)}, and its own- and the neighboring
beads' velocities V₁(tk) = {vi−1(tk), vi(tk), vi+1(tk)}. Moreover, each bead
maintains an internal vector-valued state, s₁(tr). This state can be utilized by
the respective controller to store, update, and actively share recurrent
information with other beads that is not necessarily bound to the physical
state of the swimmer but an emergent property of the collective RL system:
Every controller thus perceives its neighboring states,
Si(tk) = {si-1(tk), S₁(tk), Si+1(tk)}, which additionally guide the agent's
decision-making (see "Methods” and ref. 58 for details). In total, the per-
ception of a single bead agent is given by p₁(tk) = {L₁(tk), V₁(tk), S;(tk)}
and does not contain any agent-specific or global reward signals.

After integrating information about its local environment, pi(tk), the
controller of each bead i computes, and then outputs an action,
ai(tk) = {$i(tk), ∆s₁(tk)}, comprising a proposed active force, $₁(tk), and an
internal state update, si(tk+1) = si(tk) + ∆si(tk) (see Fig. 1b); this extends the
purely state s₁-dependent inverse pattern formation task discussed in ref. 58
with local perception-action loops in a hydrodynamic environment. The
proposed forces are limited to $₁(tk) ∈ [-Fo, Fo] by clamping the controllers'
force outputs to ±F0, where Fo sets the force scale in our system and hence
the maximum power consumption and bead velocities of the swimmer.

To model a force-free swimmer, we propose two different methods of
how the mapping between the proposed forces $₁(tk), and the actual active
forces F(tk), is achieved: First, we interpret the proposed forces as pairwise
arm forces $i(tk) and -i(tk) applied between two consecutive beads i and
i + 1, respectively (see Fig. 2a). This leads to the actual active forces F(t) =
$;(tk) - i-1 (tk) for beads i = 1..., N, where we treat the swimmer's "head"
and "tail" separately by setting ON(tk) = 0 and introducing $o(tk) = 0. This
automatically ensures ∑=1F(tk) = 0. In this sense, the proposed actions
can be understood as local decisions to expand/contract muscles between
the beads where the maximum local power input on a bead is constrained
and set by the value of Fo. Second, we assume that the proposed force $;(tr) of
every controller directly targets the actual force applied to its associated
bead, but, to fulfill the force-free condition, we subtract the mean $(tk) =
N
1 $;(tk) from every proposed force and arrive at F(tk) = $₁(tk)
$(tk) (see Fig. 2b). Hence the first approach ensures the global force-free
condition via a series of locally annihilating pair-forces motivated by bio-
logical force dipole generation at small scales that cause the arms between
the corresponding beads i and (i + 1) to contract or extend. In turn, the
second approach regularizes the forces by collective feedback (via (tr)) and
can be interpreted as a mean-field approach that may be utilized by external
controllers for artificial microswimmers³. Henceforth, we refer to the first

[PAGE 4] Transferable evolved policies: decentralized decision-making
generalizes to arbitrary morphologies

We have recently shown that biologically inspired NCA-based multi-
agent policies especially when evolved via evolutionary processes-can
display behavior that is highly robust against structural and functional
perturbations and exhibit increased generalizability, adaptability, and
transferability58,74. We thus investigate here whether our decentralized
locomotion policies, which are genuinely evolved for microswimmer
bodies with exactly N₁ beads, generalize to morphological changes. More
specifically, we carefully optimize ANN policies for a particular number
of NT = 3 to 100 beads (as discussed above) and deploy them-without
any retraining or further adaptation-into microswimmer bodies with a
different number of N = 3 to 300 beads instead to evaluate the corre-
sponding swimming velocities for such cross-policy environments.

As illustrated in Fig. 4a, b, we find that the vast majority of all
policies that are most optimal for a particular value of N₁ are also highly
effective in self-propelling microswimmers with N ≠ N₁ for both type A
and B, respectively. This even holds for situations where Nr <<N, such as
N₁ = 3 and N = 300. We did not explicitly optimize for this property at
all, but it is an emergent phenomenon of the inherent decentralized
decision-making of the system. Thus, the collective nature of the pro-
posed swimming policies renders the evolved locomotive strategies

[PAGE 6] Large-scale coordination leads to efficient locomotion

In our approach, we limit the maximum forces on each of the beads and,
thus, the maximum bead velocities. This procedure is somewhat similar

[PAGE 7] Robust- and failure tolerant locomotion and cargo transport
without re-training

Since our evolved microswimmer policies show strong resilience even
against significant morphological perturbations (see Fig. 4), we aim to
investigate this operational plasticity even further: Exemplarily for the most
optimal type A and B microswimmers with (N = 13), we systematically load
the arms with extra passive "cargo" beads of variable radius R ∈ [0, 2R], and
evaluate the dynamics of the corresponding loaded microswimmer con-
sisting now of N = 13 + 1 beads, without retraining or further optimization.

[PAGE 9] Conclusions

Our study demonstrates that machine learning of decentralized decision-
making strategies of the distributed actuators in a composite in silico
microswimmer can lead to highly efficient navigation policies of the entire
organism that are, moreover, highly robust with respect to morphological
changes or defects. More specifically, we treat each of the N beads of a
generalized NG microswimmer model as an ANN-based agent that per-
ceives information about its adjacent beads and whose actions induce
activations of adjacent muscles. Via genetic algorithms, we have optimized
such single-bead decision-making centers to collectively facilitate highly
efficient swimming gaits on the system level of the NG swimmer.

[PAGE 10] Methods

[PAGE 10] Hydrodynamic interactions and numerical details for the N-bead
swimmer model

The microswimmer consists of N hydrodynamically interacting beads
located at positions x₁(tk), i = 1, ..., N, at time tk. The bead positions change
over time by applying forces F;(tr), consisting of active (F(tr)) and passive
(F(tk)) contributions. 

[PAGE 10] Artificial neural network-based decentralized controllers

Mimicking the flexible operations of biological neural circuits, ANNs
consisting of interconnected Artificial Neurons (ANs) have become
invaluable numerical tools for statistical learning applications". 

[PAGE 11] Genetic algorithm and neuroevolution of single-agent policies
with collective goals

Genetic Algorithms (GAs) are heuristic optimization techniques inspired
by the process of natural selection. In GAs, a set (or a population) of size
Np, X = {01, ..., 0, }, of sets of parameters (or individuals), θ; e∈ Ro,
is maintained and modified over successive iterations (or generations)
to optimize an arbitrary objective function (or a fitness
score), r(0;) : RNo → R58,66.

[PAGE 11] Swimming-gait analysis

In the “Transferable evolved policies: decentralized decision-making gen-
eralizes to arbitrary morphologies" subsection of the "Results and Discus-
sion,” we define a 27-period governing equation Î¿(t) = f ((t − iī) ὦ + φ)
for the actual arm lengths l₁(tr) 

[PAGE 11] Data availability

The data that support the plots within this paper and other findings of this
study are available from the corresponding author upon request.

[PAGE 11] Code availability

The simulation code and output data are available upon reasonable request
to the corresponding author.